# Minimal Buildroot defconfig for Lichee Pi 4A

BR2_riscv=y
BR2_riscv64=y

BR2_TOOLCHAIN_BUILDROOT=y
BR2_TOOLCHAIN_INSTALL_HEADERS=y
BR2_TOOLCHAIN_EXTERNAL=y
# (or if you want Buildroot to build its own toolchain, remove/exclude above external line)
#BR2_TOOLCHAIN_EXTERNAL=y  

# Target options
BR2_ARCH="riscv"
BR2_ARCH_RISCV=y
BR2_RISCV_XLEN_64=y
BR2_ARCH_64=y

# Kernel
BR2_LINUX_KERNEL=y
BR2_LINUX_KERNEL_CUSTOM_VERSION=y
BR2_LINUX_KERNEL_CUSTOM_VERSION_VALUE="6.5"             # adjust as needed
BR2_LINUX_KERNEL_DEFCONFIG="light_lpi4a_defconfig"      # adjust to board defconfig
BR2_LINUX_KERNEL_DTS_SUPPORT=y
BR2_LINUX_KERNEL_INTREE_DTS_NAME="light-lpi4a.dtb"      # for 8GB variant, adjust if 16GB
BR2_LINUX_KERNEL_INSTALL_TARGET=y

# Bootloader (U-Boot)
BR2_TARGET_UBOOT=y
BR2_TARGET_UBOOT_CUSTOM_VERSION=y
BR2_TARGET_UBOOT_CUSTOM_VERSION_VALUE="2020.01"         # adjust version
BR2_TARGET_UBOOT_BOARD_DEFCONFIG="light_lpi4a_defconfig"

# Filesystem & rootfs
BR2_ROOTFS_EXT2=y
BR2_TARGET_ROOTFS_EXT2_4=y
BR2_ROOTFS_POST_IMAGE_SCRIPT="board/sipeed/lpi4a/post-image.sh"  # adjust if you create one

# Basic packages
BR2_PACKAGE_BUSYBOX=y
BR2_PACKAGE_DROPBEAR=y                # for SSH support
# (Alternatively choose openssh)
BR2_PACKAGE_SUDO=n                     # minimal so disable
BR2_TARGET_GENERIC_HOSTNAME="licheepi4a"
BR2_TARGET_GENERIC_ISSUE="Welcome to LicheePi 4A"
BR2_TARGET_GENERIC_GETTY_PORT="ttyS0"

# Enable the proprietary boot binaries package
BR2_PACKAGE_SIPEED_LPI4ABIN=y

# Additional optional packages: 
# network tools, filesystem tools etc
BR2_PACKAGE_IPROUTE2=y
BR2_PACKAGE_HTOP=n
BR2_PACKAGE_VIM=n

# System settings
BR2_ENABLE_UART0=y
BR2_ENABLE_CONSOLE=y
BR2_TARGET_ROOTFS_CPIO=n
# If you want initramfs instead, you could use CPIO.

# Misc
BR2_ENABLE_STATIC_LIBS=n
BR2_ENABLE_STRIP=y

# Save config
BR2_DEFCONFIG="${ADDON}/configs/licheepi4a_bridge_defconfig"

